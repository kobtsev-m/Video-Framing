(this["webpackJsonpvideo-framing"]=this["webpackJsonpvideo-framing"]||[]).push([[0],{23:function(e,t,n){},24:function(e,t,n){},25:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n(7),c=n.n(a),s=n(5),i=n.n(s),o=n(6),u=n(8),d=n(4),j=n(3),l=function(e){var t=e.frames;return Object(j.jsx)(d.b,{className:"w-100 mt-3",children:Object(j.jsxs)(d.c,{children:[Object(j.jsx)("h3",{children:"Frames:"}),Object(j.jsx)("hr",{}),t.map((function(e,t){return Object(j.jsx)("img",{src:e,alt:"...",width:160,height:90,className:"m-2"},t)}))]})})},b=n(12),f={getVideoData:function(e){return new Promise((function(t,n){var r=document.createElement("video"),a=URL.createObjectURL(e);r.addEventListener("error",(function(){n(new Error("Couldn't process the video. Please ensure the video is one of the supported formats (MP4, MOV, M4V) and streamable."))})),r.addEventListener("loadedmetadata",Object(o.a)(i.a.mark((function n(){var r;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,Object(b.getInfo)(e);case 2:r=n.sent.media.track[0],t({name:e.name.split(".").slice(0,-1).join("."),urlObject:a,duration:parseFloat(r.Duration),fps:parseFloat(r.FrameRate),framesTotal:parseInt(r.FrameCount)});case 4:case"end":return n.stop()}}),n)})))),r.preload="metadata",r.src=a}))},getVideoFrames:function(e,t,n){return console.log(n),1===n?f.getVideoFrames1(e,t):f.getVideoFrames2(e,t)},getVideoFrames1:function(e,t){return new Promise(function(){var n=Object(o.a)(i.a.mark((function n(r){var a,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(a=document.createElement("video")).addEventListener("seeked",Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c&&c();case 1:case"end":return e.stop()}}),e)})))),a.addEventListener("loadeddata",Object(o.a)(i.a.mark((function n(){var s,o,u,d,j,l,b,f;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s=document.createElement("canvas"),o=s.getContext("2d"),u=[a.videoWidth,a.videoWidth],d=u[0],j=u[1],s.width=d,s.height=j,l=e.duration/t,b=[],f=0;case 8:if(!(b.length<t)){n.next=17;break}return a.currentTime=f,n.next=12,new Promise((function(e){return c=e}));case 12:o.drawImage(a,0,0,d,j),b.push(s.toDataURL("image/jpeg")),f+=l,n.next=8;break;case 17:r(b);case 18:case"end":return n.stop()}}),n)})))),a.src=e.urlObject;case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())},getVideoFrames2:function(e,t){return new Promise(function(){var n=Object(o.a)(i.a.mark((function n(r){var a,c;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:(a=document.createElement("video")).addEventListener("seeked",Object(o.a)(i.a.mark((function e(){return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:c&&c();case 1:case"end":return e.stop()}}),e)})))),a.addEventListener("loadeddata",Object(o.a)(i.a.mark((function n(){var s,o,u,d,j,l,b,f,m,h,p;return i.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:s=document.createElement("canvas"),o=s.getContext("2d"),u=[a.videoWidth,a.videoWidth],d=u[0],j=u[1],s.width=d,s.height=j,l=e.duration/t,b=[],f=0,m=0,h=function(n){if(n){var a="".concat(e.name,"_").concat(f,".jpeg");b.push(new File([n],a,{type:"jpeg"})),f++}else f++;f===t&&r(b)},p=0;case 11:if(!(p<t)){n.next=21;break}return a.currentTime=m,n.next=15,new Promise((function(e){return c=e}));case 15:o.drawImage(a,0,0,d,j),s.toBlob(h),m+=l;case 18:++p,n.next=11;break;case 21:case"end":return n.stop()}}),n)})))),a.src=e.urlObject;case 4:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}())}};n(23);var m=function(){var e=Object(r.useState)([]),t=Object(u.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)(!1),s=Object(u.a)(c,2),b=s[0],m=s[1],h=Object(r.useState)(null),p=Object(u.a)(h,2),O=p[0],x=p[1],v=Object(r.useState)(0),g=Object(u.a)(v,2),w=g[0],k=g[1],y=Object(r.useState)(0),F=Object(u.a)(y,2),E=F[0],V=F[1],N=Object(r.useState)(""),C=Object(u.a)(N,2),S=C[0],T=C[1],L=Object(r.useState)(!1),M=Object(u.a)(L,2),P=M[0],I=M[1],D=Object(r.useState)(1),_=Object(u.a)(D,2),R=_[0],W=_[1],A=function(){var e=Object(o.a)(i.a.mark((function e(t){var n,r,a;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.target.files){e.next=2;break}return e.abrupt("return");case 2:return m(!0),x(null),T(""),W(1),e.prev=6,e.next=9,f.getVideoData(t.target.files[0]);case 9:n=e.sent,r=Math.min(100,n.framesTotal),a=Math.ceil(r/n.framesTotal*100),x(n),k(r),V(a),e.next=20;break;case 17:e.prev=17,e.t0=e.catch(6),T(e.t0.message);case 20:case"end":return e.stop()}}),e,null,[[6,17]])})));return function(t){return e.apply(this,arguments)}}(),U=function(){var e=Object(o.a)(i.a.mark((function e(t){var n;return i.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),O&&w){e.next=3;break}return e.abrupt("return");case 3:return I(!0),e.next=6,f.getVideoFrames(O,w,R);case 6:n=e.sent,I(!1),a(n),m(!1),console.log(n);case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsxs)("div",{className:"App",children:[Object(j.jsxs)(d.d,{className:"App__container",children:[Object(j.jsx)(d.b,{className:"App__formCard",children:Object(j.jsxs)(d.c,{children:[Object(j.jsx)(d.h,{children:"Select video to process:"}),Object(j.jsx)(d.g,{type:"file",lang:"en",onChange:A})]})}),!!n.length&&Object(j.jsx)(l,{frames:n})]}),Object(j.jsx)(d.i,{centered:!0,isOpen:b,children:Object(j.jsxs)(d.e,{onSubmit:U,children:[Object(j.jsx)(d.l,{toggle:function(){return m(!1)},children:"Video processing"}),Object(j.jsx)(d.j,{children:S?Object(j.jsx)("div",{className:"text-danger my-4",children:S}):O?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsxs)(d.f,{children:[Object(j.jsxs)("p",{children:[Object(j.jsx)("b",{children:"Video duration:"})," ",O.duration]}),Object(j.jsxs)("p",{children:[Object(j.jsx)("b",{children:"Video frames per second:"})," ",O.fps]}),Object(j.jsxs)("p",{children:[Object(j.jsx)("b",{children:"Total frames:"})," ",O.framesTotal]})]}),Object(j.jsx)(d.f,{children:Object(j.jsx)("video",{className:"w-100 rounded",src:O.urlObject,controls:!0,style:{maxHeight:"30vh"}})}),Object(j.jsxs)(d.f,{children:[Object(j.jsx)(d.h,{children:Object(j.jsx)("b",{children:"Number of images to load:"})}),Object(j.jsx)(d.g,{type:"text",inputMode:"numeric",pattern:"[-+]?[0-9]*[.,]?[0-9]+",value:w,onChange:function(e){if(O){var t=parseInt(e.target.value),n=Math.min(isNaN(t)?0:t,O.framesTotal),r=Math.ceil(n/O.framesTotal*100);k(n),V(r)}}})]}),Object(j.jsx)(d.f,{children:Object(j.jsx)(d.g,{type:"range",value:E,onChange:function(e){if(O){var t=parseInt(e.target.value),n=Math.floor(t/100*O.framesTotal);k(n),V(t)}}})}),Object(j.jsxs)(d.f,{children:[Object(j.jsx)(d.h,{children:Object(j.jsx)("b",{children:"Process variant:"})}),Object(j.jsxs)(d.g,{type:"select",onChange:function(e){return W(parseInt(e.target.value))},children:[Object(j.jsx)("option",{value:"1",children:"1"}),Object(j.jsx)("option",{value:"2",children:"2"})]})]})]}):Object(j.jsx)("div",{className:"d-flex justify-content-center my-4",children:Object(j.jsx)(d.m,{})})}),Object(j.jsx)(d.k,{className:"flex-row-reverse justify-content-between align-items-center",children:S?Object(j.jsx)(d.a,{color:"dark",outline:!0,onClick:function(){return m(!1)},children:"Close"}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(d.a,{type:"submit",color:"dark",outline:!0,disabled:P,children:"Process video"}),P&&Object(j.jsx)(d.m,{size:"sm",type:"grow"})]})})]})})]})};n(24);c.a.render(Object(j.jsx)(m,{}),document.getElementById("root"))}},[[25,1,2]]]);
//# sourceMappingURL=main.ba1bd6c9.chunk.js.map